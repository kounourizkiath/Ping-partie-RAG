Splunk Security Content Logo
<https://www.splunk.com/>

  *

  * Home <https://research.splunk.com/>
  * Analytic Stories <https://research.splunk.com/stories/>
  * Detections <https://research.splunk.com/detections/>
  * Playbooks <https://research.splunk.com/playbooks/>
  * Data Sources <https://research.splunk.com/sources/>
  * Attack Data <https://research.splunk.com/attack_data/>
  * Blog <https://www.splunk.com/en_us/blog/author/secmrkt-research.html>
  * About <http://splunk.com/threat-research>
  *
    GitHub Repo

    <https://github.com/splunk/security_content>
  *

GitHub Repo

<https://github.com/splunk/security_content>


    Table of Contents

  *
      o Description <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#description>
      o Search <https://research.splunk.com/endpoint/9015385a-9c84-11eb-
        bef2-acde48001122/?utm_source=chatgpt.com#search>
      o Data Source <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#data-source>
      o Macros Used <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#macros-used>
      o Annotations <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#annotations>
      o Default Configuration <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#default-configuration>
      o Implementation <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#implementation>
      o Known False Positives <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#known-false-positives>
      o Associated Analytic Story <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#associated-analytic-story>
      o Risk Based Analytics (RBA) <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#risk-based-analytics-rba>
          +
      o References <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#references>
      o Detection Testing <https://research.splunk.com/
        endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
        utm_source=chatgpt.com#detection-testing>


  Detection: Windows Multiple Users Failed To Authenticate From Process

Updated Date: 2025-05-02 ID: 9015385a-9c84-11eb-bef2-acde48001122
Author: Mauricio Velazco, Splunk Type: TTP <https://research.splunk.com/
endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
utm_source=chatgpt.com#default-configuration> Product: Splunk Enterprise
Security <https://www.splunk.com/en_us/products/enterprise-security.html>


      Description

The following analytic detects a source process failing to authenticate
with 30 unique users, indicating a potential Password Spraying attack.
It leverages Windows Event 4625 with Logon Type 2, collected from domain
controllers, member servers, and workstations. This activity is
significant as it may represent an adversary attempting to gain initial
access or elevate privileges within an Active Directory environment. If
confirmed malicious, this could lead to unauthorized access, privilege
escalation, or further compromise of the network, posing a severe
security risk.


      Search

|1`wineventlog_security` EventCode=4625 Logon_Type=2 ProcessName!="-" 
2| bucket span=5m _time 
3| stats dc(TargetUserName) AS unique_accounts values(TargetUserName) as tried_accounts values(dest) as dest values(src) as src values(user) as user by _time, ProcessName, SubjectUserName, Computer, action, app, authentication_method, signature, signature_id 
4| rename Computer as dest 
5| where unique_accounts > 30 
6| `windows_multiple_users_failed_to_authenticate_from_process_filter`

|

<https://research.splunk.com/endpoint/9015385a-9c84-11eb-bef2-
acde48001122/?utm_source=chatgpt.com#>

<https://research.splunk.com/endpoint/9015385a-9c84-11eb-bef2-
acde48001122/?utm_source=chatgpt.com#><https://research.splunk.com/
endpoint/9015385a-9c84-11eb-bef2-acde48001122/?
utm_source=chatgpt.com#><https://research.splunk.com/
endpoint/9015385a-9c84-11eb-bef2-acde48001122/?utm_source=chatgpt.com#>
spl


      Data Source

Name 	Platform 	Sourcetype 	Source
Windows Event Log Security 4625 <https://research.splunk.com/
sources/365a02c2-7d18-4baf-b76e-d90c20bbe6ed/> 	Windows icon Windows
<https://research.splunk.com/platform/windows> 	|'XmlWinEventLog'|
	|'XmlWinEventLog:Security'|


      Macros Used

Name 	Value
wineventlog_security <https://github.com/splunk/security_content/blob/
develop/macros/wineventlog_security.yml> 	|
eventtype="wineventlog_security" OR Channel="security" OR
source="XmlWinEventLog:Security" OR source="WinEventLog:Security"|
windows_multiple_users_failed_to_authenticate_from_process_filter 	|
search *|

|windows_multiple_users_failed_to_authenticate_from_process_filter| is
an empty macro by default. It allows the user to filter out any results
(false positives) without editing the SPL.


      Annotations

- MITRE ATT&CK
+ Kill Chain Phases
+ NIST
+ CIS
- Threat Actors
ID 	Technique 	Tactic
T1110.003 <https://attack.mitre.org/techniques/T1110/003/> 	Password
Spraying 	Credential Access

Exploitation
DE.CM
CIS 10
APT29
 <https://attack.mitre.org/groups/G0016> APT33
 <https://attack.mitre.org/groups/G0064> Agrius
 <https://attack.mitre.org/groups/G1030> Chimera
 <https://attack.mitre.org/groups/G0114> Ember Bear
 <https://attack.mitre.org/groups/G1003> HAFNIUM
 <https://attack.mitre.org/groups/G0125> HEXANE
 <https://attack.mitre.org/groups/G1001> Lazarus Group
 <https://attack.mitre.org/groups/G0032> Leafminer
 <https://attack.mitre.org/groups/G0077> Silent Librarian
 <https://attack.mitre.org/groups/G0122>
<https://research.splunk.com/endpoint/9015385a-9c84-11eb-bef2-
acde48001122/?utm_source=chatgpt.com>


      Default Configuration

This detection is configured by default in Splunk Enterprise Security to
run with the following settings:

Setting 	Value
Disabled 	true
Cron Schedule 	|0 * * * *|
Earliest Time 	|-70m@m|
Latest Time 	|-10m@m|
Schedule Window 	|auto|
Creates Notable 	Yes
Rule Title 	|%name%|
Rule Description 	|%description%|
Notable Event Fields 	user, dest
Creates Risk Event 	True

This configuration file applies to all detections of type TTP. These
detections will use Risk Based Alerting and generate Notable Events.


      Implementation

To successfully implement this search, you need to be ingesting Windows
Event Logs from domain controllers aas well as member servers and
workstations. The Advanced Security Audit policy setting |Audit Logon|
within |Logon/Logoff| needs to be enabled.


      Known False Positives

A process failing to authenticate with multiple users is not a common
behavior for legitimate user sessions. Possible false positive scenarios
include but are not limited to vulnerability scanners and missconfigured
systems.


      Associated Analytic Story

  *

    Active Directory Password Spraying <https://research.splunk.com/
    stories/active_directory_password_spraying/>

  *

    Insider Threat <https://research.splunk.com/stories/insider_threat/>

  *

    Volt Typhoon <https://research.splunk.com/stories/volt_typhoon/>


      Risk Based Analytics (RBA)


          Risk Message:

    Potential password spraying attack from $dest$

Risk Object 	Risk Object Type 	Risk Score 	Threat Objects
dest 	system 	49 	No Threat Objects


      References

  *

    https://attack.mitre.org/techniques/T1110/003/ <https://
    attack.mitre.org/techniques/T1110/003/>

  *

    https://docs.microsoft.com/en-us/windows/security/threat-protection/
    auditing/event-4625 <https://docs.microsoft.com/en-us/windows/
    security/threat-protection/auditing/event-4625>

  *

    https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/
    event.aspx?eventID=4625 <https://www.ultimatewindowssecurity.com/
    securitylog/encyclopedia/event.aspx?eventID=4625>

  *

    https://docs.microsoft.com/en-us/windows/security/threat-protection/
    auditing/basic-audit-logon-events <https://docs.microsoft.com/en-us/
    windows/security/threat-protection/auditing/basic-audit-logon-events>


      Detection Testing

Test Type 	Status 	Dataset 	Source 	Sourcetype
Validation 	✅ Passing <https://github.com/splunk/security_content/
actions/workflows/build.yml> 	N/A 	N/A 	N/A
Unit 	✅ Passing <https://github.com/splunk/security_content/actions/
workflows/build.yml> 	Dataset <https://media.githubusercontent.com/
media/splunk/attack_data/master/datasets/attack_techniques/T1110.003/
purplesharp_multiple_users_from_process_xml/windows-security.log> 	|
XmlWinEventLog:Security| 	|XmlWinEventLog|
Integration 	✅ Passing 	Dataset <https://media.githubusercontent.com/
media/splunk/attack_data/master/datasets/attack_techniques/T1110.003/
purplesharp_multiple_users_from_process_xml/windows-security.log> 	|
XmlWinEventLog:Security| 	|XmlWinEventLog|

Replay any dataset to Splunk Enterprise by using our |replay.py|
<https://github.com/splunk/attack_data#using-replaypy> tool or the UI
<https://github.com/splunk/attack_data#using-ui>. Alternatively you can
replay a dataset into a Splunk Attack Range <https://github.com/splunk/
attack_range#replay-dumps-into-attack-range-splunk-server>

------------------------------------------------------------------------

Source: GitHub <https://github.com/splunk/security_content/tree/develop/
detections/endpoint/
windows_multiple_users_failed_to_authenticate_from_process.yml> |
Version: *9*

Detection: Windows Multiple Users Failed To Authenticate From Host Using
NTLM <https://research.splunk.com/endpoint/7ed272a4-9c77-11eb-af22-
acde48001122/>
Detection: Windows Multiple Users Failed To Authenticate Using Kerberos
<https://research.splunk.com/endpoint/3a91a212-98a9-11eb-b86a-
acde48001122/>

© 2005 - 2025 Splunk LLC All rights reserved.

<https://research.splunk.com/endpoint/9015385a-9c84-11eb-bef2-
acde48001122/?utm_source=chatgpt.com#pagetop>

